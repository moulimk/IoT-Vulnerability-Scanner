import streamlit as st      
from stats.data_leak_detection import parse_pcap, generate_report
import os

def main():
    st.title("üõ°Ô∏è Data Leak Detection")

    st.header("Select PCAP File")
    st.subheader("Make sure you save your pcap file in the data folder")
    
    # List all PCAP files in the 'data' directory
    data_folder = './data'
    pcap_files = [f for f in os.listdir(data_folder) if f.endswith('.pcap')]

    if pcap_files:
        selected_file = st.selectbox("Choose a PCAP file from the data folder:", pcap_files)


        if st.button("Analyze"):
            st.info("Analyzing the file... this may take a few moments.")

            file_path = os.path.join(data_folder, selected_file)

            findings = parse_pcap(file_path)
            report = generate_report(findings)

            st.subheader("Results")
            st.text_area("Data Leak Report", value=report, height=250)

    else:
        st.warning("No PCAP files found in the data folder. Please add files to the folder.")



if __name__ == "__main__":
    main()

