import streamlit as st
from stats.wifi_security import get_connected_wifi_details, check_encryption, security_tips, check_vulnerable_ports_on_wifi

def main():
    st.title("Wi-Fi Security Assessment")

    st.header("Your Wi-Fi Network")
    wifi_details = get_connected_wifi_details()
    
    if wifi_details:
        # Extract relevant details (SSID and signal strength for example)
        details_parts = wifi_details.split(":")
        ssid = details_parts[1]
        signal_strength = details_parts[-1].split("Mbit")[0].strip()
        
        st.write(f"**Connected Network:** `{ssid}`")
        st.write(f"**Signal Strength:** `{signal_strength}/100` ğŸ“¶")
        
        # Check encryption and get security status
        encryption_message, is_secure = check_encryption(wifi_details)
        st.subheader("ğŸ”’ Network Security Status:")
        if is_secure:
            st.success(f"âœ”ï¸ {encryption_message}")
        else:
            st.warning(f"âš ï¸ {encryption_message}")
        
        # Provide security tips with explanations
        st.subheader("ğŸ’¡ What You Can Do:")
        st.write(
            "Your Wi-Fi security is important to protect your personal information and devices from unauthorized access. "
            "Here are some steps you can take to ensure your network is safe:"
        )
        
        tips = security_tips(is_secure)
        for tip in tips:
            st.write(f"- {tip}")
        
        # Scan for vulnerable open ports
        st.subheader("ğŸ” Vulnerable Ports Check:")
        
        with st.spinner("Checking Vulnerable ports"):
            vulnerable_ports = check_vulnerable_ports_on_wifi()
            if vulnerable_ports:
                st.warning(f"âš ï¸ Vulnerable open ports detected: {vulnerable_ports}. It's recommended to secure these ports.")
            else:
                st.success("âœ”ï¸ No known vulnerable open ports detected.")
    else:
        st.error("âŒ We couldn't retrieve your Wi-Fi details. Please make sure you're connected to a Wi-Fi network.")
    
if __name__ == "__main__":
    main()
    
